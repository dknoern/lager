<style>
    .form-group.required .control-label:after {
        content: " *";
        color: darkred;
    }
</style>

<script>

    function buildLongDesc() {
        var title = document.getElementById('title').value;
        var modelName = document.getElementById('model').value;
        var features = document.getElementById('features').value;
        var caseText = document.getElementById('case').value;
        var dial = document.getElementById('dial').value;
        var bracelet = document.getElementById('bracelet').value;
        var comments = document.getElementById('comments').value;

        var longDesc = title + ' - ';

        longDesc = addLongDescPart(longDesc, features);
        longDesc = addLongDescPart(longDesc, model);
        longDesc = addLongDescPart(longDesc, caseText);
        longDesc = addLongDescPart(longDesc, dial);
        longDesc = addLongDescPart(longDesc, bracelet);
        longDesc = addLongDescPart(longDesc, comments);

        var longDescField = document.getElementById("longDesc");
        var element = angular.element(longDescField);
        element.val(longDesc);
        element.triggerHandler('input');
    }

    function addLongDescPart(longDesc, part) {
        if (part && part.length > 0)
            longDesc += part + '. ';
        return longDesc;
    }

    function selectCustomer(id){
      $('#customerModal').modal('hide')
       document.location.href = "/#/app/invoice/edit/new?customerId="+id + "&productId="+document.getElementById('itemNumber').value;
    }
</script>

<div data-ng-controller="ItemCtrl">

  <div class="row">
      <div class="col-md-10">
          <h1 class="page-title"><span class="fw-semi-bold">Product</span></h1>
      </div>
      <div class="col-md-2">

          <div class="btn-group" data-dropdown>
              <button class="btn btn-success dropdown-toggle" data-dropdown-toggle data-original-title="" title="">
          &nbsp; Action &nbsp;
          <i class="fa fa-caret-down"></i>
        </button>

              <ul class="dropdown-menu">
                  <!--li><a href="/#/app/item/{{data._id}}/edit">Edit</a></li>
                  <li>Add photos</li>
                  <li>Sell</li>
                  <li>Out to show</li-->
                  <li ng-if="'In Stock' == data.status || 'Memo' == data.status"><a href="#" data-toggle="modal" data-target="#customerModal">Create Invoice</a></li>
                  <!--li class="divider"></li-->
                  <li><a href="#" data-toggle="modal" data-target="#deleteModal">Delete</a></li>
              </ul>
          </div>
      </div>

      <!-- Delete Modal -->
      <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
          <div class="modal-dialog modal-sm" role="document">
              <div class="modal-content">
                  <div class="modal-body">
                    Are you sure you want to delete item <b>{{data._id}} - {{data.title}}</b>?
                  </div>
                  <div class="modal-footer">
                      <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Cancel</button>
                      <button type="button" class="btn btn-success btn-sm" ng-click="deleteItem()" data-dismiss="modal">Delete</button>
                  </div>
              </div>
          </div>
      </div>


      <!-- Invoice Modal -->
      <div class="modal fade" id="customerModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
          <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                  <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                      <h4 class="modal-title" id="myModalLabel">Select customer for invoice</h4>
                  </div>
                  <div class="modal-body">

                    <p>



                      <a href="#" onclick="selectCustomer('new')"><button type="button" class="btn btn-primary"><span class="icon">
                        <i class="fa fa-plus-circle"></i>
                      </span>New Customer</button></a>
                    </p>

                    <table id="customerTable" class="display" cellspacing="0" width="100%">
                        <thead>
                            <tr>
                                <th>Number</th>
                                <th>Name</th>
                                <th>City</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Company</th>
                            </tr>
                        </thead>
                    </table>
                  </div>
                  <div class="modal-footer">
                      <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">Cancel</button>
                  </div>
              </div>
          </div>
      </div>



  </div>

    <div class="row">
        <div class="col-md-12">
            <section class="widget">
                <div class="widget-body">
                    <form name="productForm" class="form-horizontal" role="form" data-ui-jq="parsley" data-parsley-priority-enabled="false" novalidate="novalidate">
                        <div class="row">
                            <div class="col-sm-7">
                                <fieldset>
                                    <div class="form-group required">
                                        <label for="productType" class="col-sm-3 control-label">Product Type</label>
                                        <div class="col-sm-8">
                                            <select ng-model="data.productType" id="productType" class="selectpicker form-control" data-selectpicker data-width="auto" required>
                                              <option></option>
                                              <option>Accessories</option>
                                              <option>Jewelry</option>
                                              <option>Watch</option>
                                              <option>Pocket Watch</option>
                                              </select>
                                        </div>
                                    </div>

                                    <div class="form-group required">
                                        <label for="title" class="col-sm-3 control-label">Title</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="title" class="form-control" ng-model="data.title" required="required" onchange="buildLongDesc()">
                                        </div>
                                    </div>


                                    <div class="form-group">
                                        <label for="hint-field" class="col-sm-3 control-label">Manufacturer</label>
                                        <div class="col-sm-8">
                                            <select ng-model="data.manufacturer" id="manufacturer" class="selectpicker" data-selectpicker data-width="auto">
                    <option></option>
                    <option>A. Lange & Sohne</option>
                    <option>Audemars Piguet</option>
                    <option>Baume & Mercier</option>
                    <option>Blancpain</option>
                    <option>Breguet</option>
                    <option>Breitling</option>
                    <option>Bvlgari</option>
                    <option>Cartier</option>
                    <option>Chanel</option>
                    <option>Chopard</option>
                    <option>Chronoswiss</option>
                    <option>Concord</option>
                    <option>Corum</option>
                    <option>Ebel</option>
                    <option>F.P. Journe</option>
                    <option>Franck Muller</option>
                    <option>Gerald Genta</option>
                    <option>Girard-Perregaux</option>
                    <option>Hublot</option>
                    <option>IWC</option>
                    <option>Jaeger-LeCoultre</option>
                    <option>Movado</option>
                    <option>Omega</option>
                    <option>Panerai</option>
                    <option>Parmigiani</option>
                    <option>Patek Philippe & Co</option>.
                    <option>Piaget</option>
                    <option>Roger Dubuis</option>
                    <option>Rolex</option>
                    <option>Ulysse Nardin</option>
                    <option>Vacheron Constantin</option>
                    <option>Additional Brands</option>
                    <option>Maurice Lacroix</option>
                    <option>Zenith</option>
                    </select>
                                        </div>
                                    </div>


                                    <div class="form-group">
                                        <label for="normal-field" class="col-sm-3 control-label">Item No</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="itemNumber" class="form-control" ng-model="data._id" readonly="readonly">
                                        </div>
                                    </div>


                                    <!--div class="form-group">
                                        <label for="hint-field" class="col-sm-3 control-label">Pmt Amount</label>
                                        <div class="col-sm-8">
                                            <div class="input-group">
                                                <span class="input-group-addon">$</span>
                                                <input type="number" min="0" step="0.01" data-number-to-fixed="2" data-number-stepfactor="100" class="form-control currency" id="paymentAmount" ng-model="data.paymentAmount">

                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="method" class="col-sm-3 control-label">Pmt Method</label>
                                        <div class="col-sm-8">
                                            <select ng-model="data.paymentMethod" id="paymentMethod" class="selectpicker" data-selectpicker data-width="auto">
                  <option></option>
                  <option>Cash</option>
                  <option>Check</option>
                  <option>Card</option>
                  <option>Paypal</option>
                </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="hint-field" class="col-sm-3 control-label">Pmt Details</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="paymentDetails" class="form-control" ng-model="data.paymentDetails">
                                        </div>
                                    </div-->




                                    <div class="form-group">
                                        <label for="hint-field" class="col-sm-3 control-label">Model Name</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="model" class="form-control" ng-model="data.model" onchange="buildLongDesc()">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="hint-field" class="col-sm-3 control-label">Model Number</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="modelNumber" class="form-control" ng-model="data.modelNumber">
                                        </div>
                                    </div>


                                    <div class="form-group">
                                        <label for="hint-field" class="col-sm-3 control-label">Condition</label>
                                        <div class="col-sm-8">
                                            <select ng-model="data.condition" id="condition" class="selectpicker" data-selectpicker data-width="auto">
                  <option></option>
                  <option>Pre-owned</option>
                  <option>Unused</option>
                </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="hint-field" class="col-sm-3 control-label">Gender</label>
                                        <div class="col-sm-8">
                                            <select ng-model="data.gender" id="gender" class="selectpicker" data-selectpicker data-width="auto">
                  <option></option>
                  <option>Ladies</option>
                  <option>Men's</option>
                  <option>Ladies or Men's</option>
                  <option>Midsize</option>
                  <option>Unisex</option>
                </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="hint-field" class="col-sm-3 control-label">Features</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="features" class="form-control" ng-model="data.features" ng-disabled="data.productType != 'Watch' && data.productType != 'Pocket Watch'" onchange="buildLongDesc()">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="hint-field" class="col-sm-3 control-label">Case</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="case" class="form-control" ng-model="data.case" ng-disabled="data.productType != 'Watch' && data.productType != 'Pocket Watch'" onchange="buildLongDesc()">
                                        </div>
                                    </div>


                                    <div class="form-group">
                                        <label for="hint-field" class="col-sm-3 control-label">Dial</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="dial" class="form-control" ng-model="data.dial" ng-disabled="data.productType != 'Watch' && data.productType != 'Pocket Watch'" onchange="buildLongDesc()">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="hint-field" class="col-sm-3 control-label">Bracelet</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="bracelet" class="form-control" ng-model="data.bracelet" ng-disabled="data.productType != 'Watch'" onchange="buildLongDesc()">
                                        </div>
                                    </div>


                                    <div class="form-group">
                                        <label for="hint-field" class="col-sm-3 control-label">Serial No</label>
                                        <div class="col-sm-8">
                                            <input type="text" id="serialNo" class="form-control" ng-model="data.serialNo">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="hint-field" class="col-sm-3 control-label">Long Desc</label>
                                        <div class="col-sm-8">
                                            <textarea class="form-control" rows="4" id="longDesc" ng-model="data.longDesc"></textarea>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                            <div class="col-sm-5">

                                <div class="form-group required">
                                    <label for="sellerType" class="col-sm-3 control-label">Seller Type</label>
                                    <div class="col-sm-8">
                                        <select id="sellerType" class="selectpicker" data-selectpicker data-width="auto" ng-model="data.sellerType" required>
                    <option></option>
                    <option>Individual</option>
                    <option>Partner</option>
                    <option>Consignment</option>
                  </select>
                                    </div>
                                </div>

                                <div class="form-group required">
                                    <label for="seller" class="col-sm-3 control-label">Seller</label>
                                    <div class="col-sm-8">
                                        <input type="text" id="seller" class="form-control" ng-model="data.seller" required>
                                    </div>
                                </div>


                                <div ng-if="'Partner' == data.sellerType" >
                                  <a href="/#/app/partnerinvoice/{{data._id}}">Partner invoice</a>
                                </div>

                                <div class="form-group">
                                    <div class="col-sm-3"></div>
                                    <div class="col-sm-8">
                                        <div class="form-group checkbox checkbox-primary">
                                            <input type="checkbox" id="ebay" ng-model="data.ebayNoReserve">
                                            <label for="ebay">Ebay NR</label>
                                        </div>

                                        <div class="form-group checkbox checkbox-primary">
                                            <input type="checkbox" id="inventory" ng-model="data.inventoryItem">
                                            <label for="inventory">Inventory</label>
                                        </div>
                                    </div>
                                </div>


                                <div class="form-group">
                                    <label for="hint-field" class="col-sm-3 control-label">Status</label>
                                    <div class="col-sm-8">

                                        <!--select id="status" class="selectpicker" data-selectpicker data-width="auto" ng-model="data.status">
                                        <option>In Stock</option>
                                        <option>Sale Pending</option>
                                        <option>Repair</option>
                                        <option>At Show</option>
                                        <option>Unavailable</option>
                                      </select-->
                                        <input type="text" id="status" class="form-control" ng-model="data.status" readonly="readonly">
                                    </div>
                                </div>

                                </fieldset>

                                <div class="form-group">
                                    <label for="normal-field" class="col-sm-3 control-label">Box and Papers</label>
                                    <div class="col-sm-8">
                                        <textarea id="comments" rows=6 cols="40" class="form-control" ng-model="data.comments" onchange="buildLongDesc()">{{data.comments}}</textarea>
                                    </div>
                                </div>

                                <div class="clearfix">
                                    <ul id="tabs1" class="nav nav-tabs pull-left">
                                        <!-- remove pull-left to get a cool effect too -->
                                        <li class="active"><a data-target="#tab1" data-toggle="tab">Financials</a></li>
                                        <li class=""><a data-target="#tab2" data-toggle="tab">History</a></li>
                                        <li class=""><a data-target="#tab5" data-toggle="tab">Repairs</a></li>
                                    </ul>
                                </div>

                                <div id="tabs1c" class="tab-content mb-lg">
                                    <div class="tab-pane active clearfix" id="tab1">
                                        <fieldset>
                                            <div class="form-group">
                                                <label for="normal-field" class="col-sm-3 control-label">List Price</label>
                                                <div class="col-sm-8">
                                                    <div class="input-group">
                                                        <span class="input-group-addon">$</span>
                                                        <input type="number" min="0" step="0.01" data-number-to-fixed="2" data-number-stepfactor="100" class="form-control currency" id="paymentAmount" ng-model="data.listPrice">
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label for="normal-field" class="col-sm-3 control-label">Cost</label>
                                                <div class="col-sm-8">
                                                    <div class="input-group">
                                                        <span class="input-group-addon">$</span>
                                                        <input type="number" min="0" step="0.01" data-number-to-fixed="2" data-number-stepfactor="100" class="form-control currency" id="paymentAmount" ng-model="data.paymentAmount">
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label for="normal-field" class="col-sm-3 control-label">Repair Cost</label>
                                                <div class="col-sm-8">
                                                    <div class="input-group">
                                                        <span class="input-group-addon">$</span>
                                                        <input type="number" min="0" step="0.01" data-number-to-fixed="2" data-number-stepfactor="100" class="form-control currency" id="paymentAmount" ng-model="data.totalRepairCost">
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label for="normal-field" class="col-sm-3 control-label">Total Cost</label>
                                                <div class="col-sm-8">
                                                    <div class="input-group">
                                                        <span class="input-group-addon">$</span>
                                                        <input type="number" min="0" step="0.01" data-number-to-fixed="2" data-number-stepfactor="100" class="form-control currency" id="paymentAmount" value="{{(data.paymentAmount-0) + (data.totalRepairCost-0)}}" disabled="disabled">
                                                    </div>
                                                </div>
                                            </div>
                                        </fieldset>

                                    </div>
                                    <div class="tab-pane" id="tab2">
                                        <table class="table table-striped table-hover">
                                            <thead>
                                                <tr>
                                                    <th>Date</th>
                                                    <th>User</th>
                                                    <th>Activty</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr data-ng-repeat="historyEntry in data.history">
                                                    <td>{{historyEntry.date | date : "MM/dd/y"}}</td>
                                                    <td>{{historyEntry.user}}</td>
                                                    <td>{{historyEntry.action}}</td>
                                                </tr>
                                            </tbody>
                                        </table>

                                        <!--button type="button" class="btn btn-success">Change Status</button-->
                                    </div>


                                    <div class="tab-pane" id="tab5">
                                    </div>
                                </div>


                                <!--div class="clearfix">
            <button class="btn btn-default mb-xs" role="button">
              Upload Image
            </button>
            </div-->


                                <div>
                                    <table>
                                        <tr>
                                            <td data-ng-repeat="image in images">
                                                <img ng-src="{{image}}" width=70%>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>

                        </fieldset>
                        <div class="form-actions">
                            <div class="row">
                                <div class="col-sm-offset-4 col-sm-7">
                                    <button type="submit" class="btn btn-primary" ng-click="go()" ng-disabled="productForm.$invalid">Save</button>
                                    <a href="/#/app/inventory"><button type="button" class="btn btn-inverse"> Cancel</button></a>
                                    </div>


                            </div>
                        </div>
                    </form>
                </div>
            </section>
        </div>
    </div>


    <div class="row">



        <div class="row">
            <div class="col-md-12">
                <div class="col-md-6">
                    <section class="widget">
                        <header>
                            <h5><strong>Image Upload</strong></h5>
                        </header>
                        <div class="widget-body">
                            <form class="dropzone" action="/api/upload" data-dropzone action="#" id="myDropzone">
                                <input type="hidden" name="itemId" value="{{itemId}}" />
                            </form>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </div>

  </div>
